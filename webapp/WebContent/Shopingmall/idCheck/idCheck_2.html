<!DOCTYPE html>
<html>
<head>
<meta charset="EUC-KR">
<title>아이디 중복 확인함</title>
<script src = "http://code.jquery.com/jquery-latest.min.js"></script>
<script type="text/javascript">
	
	window.onload = function ()
	{
		var id = opener.$("#id").val();
		$("#t_id").val(id);
		fn_process();
	// 실행할 자바스크립트 함수
	
	}
	

	function fn_process(){
		var _id = $("#t_id").val(); 
		if(_id==''){
			alert("ID를 입력하세요");
			return;
		}
		
		$.ajax({
			type:"post",
			dataType : "text",
			async : false,
			url : "http://localhost:8080/webapp/NonageServlet?command=idCheck",
			data : {id: _id},
			success:function(data,textStatus){
				if(data == 'usable'){
					$('#message').text("사용할 수 있는 id입니다.");
					$('#btn_duplicate').prop("disabled",true);
					//사용할 수 있는 id일 때는 block하기
				}else{
					$('#message').text("사용할 수 없는 id입니다.");
				}
			},
			/* error:function(data,textStatus){
				alert("에러가 발생했습니다");
			},
			complete:function(data,textStatus){
				alert("작업을 완료했습니다.");
			} */
		});
	}
	
	function sendId() {
		 $("#id",opener.document).val($("#t_id").val());
     	 self.close(); 
     	/*  alert($("#t_id").val());
     	 opener.document.formm.p_id.value = $("#t_id").val(); */
     	 /* self.close(); */
		
	}
</script>
</head>
<body>
아이디는 영문(소문자), 숫자로 4~16자 이내로 입력해 주세요. 수정!<br>
<input type = "text" id = "t_id"/>
<input type = "button" id = "btn_duplicate" value = "ID 중복체크하기" onClick = "fn_process()"/><br><br>
<div id = "message"></div>
</body>
<footer>
<input type = "button" id = "use" value = "사용하기" onclick = "sendId()"/>
</footer>
</html>